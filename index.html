<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet" type="text/css">
  <!-- <link href="https://cdn.jsdelivr.net/npm/quasar@2.0.3/dist/quasar.prod.css" rel="stylesheet" type="text/css"> -->
  <!-- <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons|Material+Icons+Outlined|Material+Icons+Round|Material+Icons+Sharp" rel="stylesheet" type="text/css"> -->
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@^5.0.0/css/materialdesignicons.min.css" rel="stylesheet" type="text/css">
  <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/ionicons@^4.0.0/dist/css/ionicons.min.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/eva-icons@^1.0.0/style/eva-icons.css" rel="stylesheet" type="text/css">
  <link href="https://themify.me/wp-content/themes/themify-v32/themify-icons/themify-icons.css" rel="stylesheet" type="text/css">
  <link href="https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@^1.0.0/font/bootstrap-icons.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/animate.css@^4.0.0/animate.min.css" rel="stylesheet" type="text/css">
  <link href="https://cdn.jsdelivr.net/npm/quasar@2.0.3/dist/quasar.rtl.prod.css" rel="stylesheet" type="text/css">
<style type="text/css">
body.desktop .q-focusable:focus .q-focus-helper,
body.desktop .q-hoverable:hover .q-focus-helper {
background: inherit;
opacity: 0.5;
}
body.ios .q-hoverable:active .q-focus-helper {
background: inherit;
opacity: 0;
}
.q-focus-helper {
opacity: 0;
transition: unset;
}
.my-card {
  width: 100%;
  max-width: 350px
}
.my_hover{
background: inherit;
opacity: .5!important;
}
</style>
</head>
<body>
 

<div id="q-app" class="q-pa-md row items-start q-gutter-md">


    <q-card class="my-card" flat bordered>
      <q-item>
        <q-item-section avatar>
          <q-avatar >
            <img src="https://cdn.quasar.dev/img/boy-avatar.png" >
          </q-avatar>
        </q-item-section>

        <q-item-section>
          <q-item-label>10 words for Day</q-item-label>
          <q-item-label caption>
            Copyright ©2021 Prisca.
          </q-item-label>
        </q-item-section>
      </q-item>

      <q-separator></q-separator>

      <q-card-section class="text-h6" vertical  >
        <q-item clickable v-ripple v-for="(word,index) in todoList" :key="index">
        <q-item-section  class="text-black" @click="wordmeaning(index)">
          {{ word.title }}
        </q-item-section>
        <q-item-section avatar>
            <q-btn flat round color="red" icon="swap_horiz" @click="changeword(word.id)"></q-btn>
        </q-item-section>
            <!-- <q-item-section avatar>
              <q-btn label="背完" flat round color="accent" icon="verified_user" @click="setRemeberWord(word.title,word.id)"></q-btn>
            </q-item-section> -->
      </q-item>
      </q-card-section>

      <q-separator></q-separator>
      <q-input v-model="text" :dense="dense" class="text-h6" @keyup.enter="newWord(text)">

      </q-input>

    </q-card>

    <q-card class="my-card">
      <q-item>
        <q-img
          class="col-5 text-h6"
          src="https://cdn.quasar.dev/img/parallax1.jpg"
          @click="historymeaning(lastword)"
        ></q-img>
       <q-separator vertical class="q-mx-lg"></q-separator>       

        <q-item-section >
          <q-item-label  >
            <div v-if=storeOr>
            <q-btn  :label="thisword" no-caps flat class="no-padding text-blue text-h6" @click="setRemeberWord(thisword,thisId)">
            <q-icon name="verified_user" v-if=showOr style="color: #9b9095; font-size: 1em"  />
          </q-btn>
          </div>  
          <div v-else>
            <q-btn :label="thisword"  no-caps flat class="no-pointer-events no-padding text-green text-h6" >
            <q-icon name="verified_user" v-if=showOr style="color: #9b9095; font-size: 1em"  />
            </q-btn>  
          </div>
        </q-item-label>
            <q-item-label  >
              <q-btn :label="phonetic" no-caps flat class="no-padding text-red text-h6" @click="playSound(phoneticAudio)" >
              <q-icon name="volume_up"  v-if=showOr style="color: #9b9095; font-size: 1em"  />
              </q-btn>
            </q-item-label>
        </q-item-section>
      </q-item>
      
      <q-separator></q-separator>

      <q-card-section class="text-h6" vertical  >
        <q-card-actions vertical >
            <div class=" q-gutter-0 text-purple" >
              <q-btn label="Meaning:" no-caps flat class="no-padding text-purple q-py-0 text-h6" @click="changeMeaning(currentNumber)" />
              <q-badge  v-if=showOr color="orange" floating hidden>{{meaningNumber}}</q-badge>
            </q-btn >
            {{partofSpeech}} {{ wordMeaning }} 
            </div>
            <q-separator></q-separator>
            <q-item-section class="text-red">
            Example: {{ wordExample }}
          </q-item-section>
        </q-card-actions>
      </q-card-section>

      <q-separator horizontal></q-separator>
      <q-item>
        <q-item-section top class="flex-left " > Synonym
            <q-separator ></q-separator>

          <q-item  dense calss="dense"  clickable v-for="(synonym,index) in synonymList" :key="index">
              <q-item-label @click="historymeaning(synonym)">
                {{synonym}}  
              </q-item-label>
            </q-item>
          </q-item-section>

          <q-separator vertical class="q-mx-lg"></q-separator>

            <q-item-section top> Antonym
              <q-separator ></q-separator>
            <q-item dense calss="dense" clickable v-for="(antonym,index) in antonymList" :key="index">
                <q-item-label @click="historymeaning(antonym)">
                  {{antonym}}  
              </q-item-label>
            </q-item>
            </q-item-section>
        </q-item>
    </q-card>

    <div class="my-card" :style="{display:isDisplay}" flat bordered>
      <q-card   >
          <q-card-section class="text-h6" vertical >

            <q-btn flat round color="green" icon="exit_to_app" @click="gameOver()"></q-btn>
            <q-btn flat round color="green" icon="quiz" @click="random_item()"></q-btn>
            <q-btn flat round color="green" icon="question_answer" @click="answerQuiz()"></q-btn>

            <q-separator></q-separator>

            <q-item>
                {{ quiztxt }}
            </q-item>

            <q-separator></q-separator>

            <q-item clickable v-ripple v-for="(word,index) in showList" :key="index">
              <q-item-section @click="gameMatch(word.title)" >
                {{ word.title }}
              </q-item-section>
            </q-item>

            </q-card-section>   
        </q-card>
      </div>  

  <div class="my-card" flat bordered >
    <q-card >
      <q-card-section  class="text-h5">
          <q-btn push :label=showDate flat  class="q-py-0" icon="date_range" @click="setGame()">
          </q-btn>
            <q-card-section vertical class="text-h6 text-blue" >
              <q-item clickable v-ripple v-for="(word,index) in showList" :key="index">
                <q-item-section @click="historymeaning(word.title)" >
                  {{ word.title }}
                </q-item-section>
              </q-item>
            </q-card-section>
     </q-card-section>

      <q-separator></q-separator>

      <q-card-actions>
          <div class="q-pa-md">
              <q-carousel
                animated
                v-model:fullscreen="isFullscreen"
                v-model="slide"
                arrows
                infinite
                padding
                height="50px" 
                control-color="primary"
              >
              <template v-for="(item,index) in yearList">
              <q-carousel-slide :name=index class="column no-wrap flex-center">
                <q-btn push :label=numtoStringY(item.year) 
                @click="setYearlist(item.year)" flat icon="date_range" />
                <q-badge color="orange" floating>{{item.number}}</q-badge>
              </q-carousel-slide>
              </template>
              </q-carousel>
          </div>
      </q-card-actions>
  
      <q-separator></q-separator>

      <q-card-actions>
      <div class="q-pa-md">
          <q-carousel
            animated
            v-model:fullscreen="isFullscreen"
            v-model="slide1"
            arrows
            infinite
            padding
            height="50px" 
            control-color="primary"
          >
            <template v-for="(item,index) in monthfilterList">
               <q-carousel-slide :name=index class="column no-wrap flex-center">
              <q-btn push :label=numtoStringM(item.year,item.month+1)
              @click="setMonthlist(item.year,item.month)" flat icon="date_range" />
              <q-badge color="orange" floating>{{item.number}}</q-badge>
              </q-carousel-slide>
            </template>
          </q-carousel>
      </div>
    </q-card-actions>

    <q-separator></q-separator>
      
      <q-card-actions vertical>
        <!-- <template -->
        <div v-for="(item,index) in historyList" :key="index">
          <q-item v-if="item.year==showYear && item.month==showMonth">
              <q-btn  push :label= numtoString(item.year,item.month+1,item.day) flat class="q-py-0" icon="date_range"/
              @click="setShowlist(item.year,item.month,item.day)">
              <q-badge color="orange" floating>{{item.number}}</q-badge>
              </q-btn>
          </q-item>  
        </div>      
      </q-card-actions>

    </q-card>
  </div>


</div>

<script src="https://unpkg.com/vue@next"></script>
<script src="https://cdn.jsdelivr.net/npm/quasar@2.0.3/dist/quasar.umd.prod.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>

<script type="module">

  const { createApp, ref, reactive, onMounted, computed  } = Vue;

  const app = {
  setup () {
      const { useQuasar } = Quasar;
      const todoList = reactive([]);
      const todoList1 = reactive([]);
      const newTodo = ref('');
      const isDisplay = ref('none');
      var words = [];
      var i=0;
      var j=0;
      var k=0;
      var m=0;
      var n=0;
      const history = reactive([]);
      const historyList = reactive([]);
      const yearList = reactive([]);
      const monthList = reactive([]);
      const monthfilterList = reactive([]);
      const showList = reactive([]);
      const meaningList = reactive([]);
      const meaningameList =reactive([]);
      const answeris= ref('');
      const answerExample = ref('');
      const answerAudio = ref('');
      const quiztxt= ref('');
      const showDate = ref('');
      const showYear = ref();
      const showMonth = ref();
      const wordMeaning = ref('');
      const wordExample = ref('');
      const thisword = ref('');
      const thisId = ref(0);
      const lastword = ref('');
      const phonetic = ref('');
      const phoneticAudio = ref('');
      const meaningNumber = ref('');
      const partofSpeech =ref('');
      const currentNumber = ref(0);
      const synonymList = ref([]);
      const antonymList = ref([]);
      const rememberofYear = ref(0);
      const rememberofToday = ref(0);
      const rememberofMonth = ref(0);
      const rememberofshow = ref(0);
      const showOr = ref(false);
      const storeOr = ref(true);
      const isFullscreen = ref(false);

      const slide1= ref(0);
      const slide= ref(0);
      const text = ref('');


      const $q = useQuasar();

      onMounted(() => {
        var d= new Date();
          showDate.value= numtoString(d.getFullYear(),d.getMonth()+1,d.getDate());
          showYear.value=d.getFullYear();
          showMonth.value=d.getMonth(); 
          axios.get('https://random-word-api.herokuapp.com/word?number=10')
          .then((response) => {
              words=response.data;
              for (i=0;i<10;i++) {
                  // 定義todoList的格式: id(唯一值), title(單字), Completed(背好沒) 
                  todoList.push({
                  id: Date.now()+i,
                  title: words[i],
                  completed: false,
                  });
              }
          });
            // 透過getRemeberWord，抓取存在localstorage的單字
               getRememberWord();
                history.forEach(function(obj) {
                  checkhistory(obj);
                });
                historyList.forEach(function(obj){
                  checkMonth(obj);
                })
                monthList.forEach(function(obj){
                  checkYear(obj);
                })

                setYearlist(showYear.value);

      });  // complete onMounted

          const newWord = (sword) =>{
            todoList.push({
                  id: Date.now(),
                  title: sword,
                  completed: false,
                  });
            text.value='';
          }

          const historymeaning = (sword) => {
                synonymList.value=[''];
                antonymList.value=[''];
                meaningList.length=0;
                meaningNumber.value=0;
                // showOr.value=false;
                storeOr.value=false;
                var isComplete= false;
                axios.get('https://api.dictionaryapi.dev/api/v2/entries/en_US/'+sword )
                .then((response) => {
                  if(response.request.readyState === 4 && response.status === 200){ //有load完才跑下面
                    // check data.length
                    var childArray=response.data;

                    for (j=0;j<childArray.length;j++){ 
                      for (k=0;k<childArray[j].meanings.length;k++){
                          meaningNumber.value+=childArray[j].meanings[k].definitions.length;
                        };};
                    j=0; k=0; m=0; n=0; //meaningList=[]; 
                    while (!isComplete) {

                      if (j<childArray.length) {

                        if (k<childArray[j].meanings.length) {

                          for (m=0;m<childArray[j].meanings[k].definitions.length;m++) {
                            meaningList.push({
                                  mId : n,
                                  partofSpeech: childArray[j].meanings[k].partOfSpeech,
                                  definition: childArray[j].meanings[k].definitions[m].definition,
                                  example: childArray[j].meanings[k].definitions[m].example,
                                  synonyms: childArray[j].meanings[k].definitions[m].synonyms,
                                  antonyms: childArray[j].meanings[k].definitions[m].antonyms,
                                  });
                            n++;
                              }; // end the third
                              k++;
                        } else // else of the second
                        {
                          j++;k=0;
                        } // end of the second 
                      } else // else of first
                      {
                      isComplete = true;
                      } // end of the first
                    } // end of while   
                    wordMeaning.value=response.data[0].meanings[0].definitions[0].definition;
                    wordExample.value=response.data[0].meanings[0].definitions[0].example;
                    showOr.value=true;
                    phonetic.value='['+response.data[0].phonetic+']';
                    phoneticAudio.value="https:"+response.data[0].phonetics[0].audio;
                    // meaningNumber.value=response.data[0].meanings[0].definitions.length;
                    partofSpeech.value='('+response.data[0].meanings[0].partOfSpeech+')';
                    synonymList.value = response.data[0].meanings[0].definitions[0].synonyms;
                    antonymList.value = response.data[0].meanings[0].definitions[0].antonyms;
                    lastword.value=thisword.value;
                    thisword.value=sword;
                    currentNumber.value=1;
                  }else{ 
                    console.log("error"); //萬一沒load完就跑下面顯示錯誤提示
                  }
                })
                .catch( (error) => {
                  console.log(error);
                  wordMeaning.value="";
                  wordExample.value="";
                  partofSpeech.value="";
                  thisword.value="["+sword+"] not found";
                  phonetic.value="";
                  synonymList.value=[''];
                  antonymList.value=[''];
                });
               };

               const random_item = () =>{
                var definitionR;  
                var rectangle=meaningameList[Math.floor(Math.random()*meaningameList.length)];
                  for (const key in rectangle) {
                      if (key == "word") {
                        answeris.value=rectangle[key];
                      }
                      if (key == "definition")
                        definitionR=rectangle[key];
                      if (key == "example")
                        answerExample.value= rectangle[key];
                      if (key== "phoneticaudio")
                        answerAudio.value = rectangle[key];   
                    }
                    quiztxt.value=definitionR;
                    return definitionR;
                }      
               
                const  answerQuiz = () => {
                 $q.notify({
                  message: answeris.value,
                  icon: 'question_answer'
                 })

               }

                const gameMatch = (answerWord) => {
                 if (answerWord == answeris.value){ 
                 $q.notify({
                  message: 'Bingo' ,
                  icon: 'thumb_up_off_alt'
                 })
                 console.log(answerExample.value);
                 if ( answerExample.value != null )
                 $q.notify({
                  message: answerExample.value ,
                  icon: 'refresh'
                 })
                 playSound(answerAudio.value);

                }

                 else 
                 $q.notify({
                  message: 'Try again',
                  icon: 'thumb_down_off_alt'
                 })

               }

               const setGame = () => {
                meaningameList.length=0;
                 showList.forEach(item => {
                  meaningforGame(item.title);
                 })
                 isDisplay.value='block';
                 random_item();
               }
               const gameOver = () => {
                 isDisplay.value='none';
               }

               const meaningforGame = (sword) => {
                var isComplete= false;
                axios.get('https://api.dictionaryapi.dev/api/v2/entries/en_US/'+sword )
                .then((response) => {
                  if(response.request.readyState === 4 && response.status === 200){ //有load完才跑下面
                    // check data.length
                    var childArray=response.data;

                    for (j=0;j<childArray.length;j++){ 
                      for (k=0;k<childArray[j].meanings.length;k++){
                        };};
                    j=0; k=0; m=0; n=0; //meaningList=[]; 
                    while (!isComplete) {

                      if (j<childArray.length) {

                        if (k<childArray[j].meanings.length) {

                          for (m=0;m<childArray[j].meanings[k].definitions.length;m++) {
                            meaningameList.push({
                                  word : sword,
                                  definition: childArray[j].meanings[k].definitions[m].definition,
                                  example: childArray[j].meanings[k].definitions[m].example,
                                  phoneticaudio: "https:"+response.data[0].phonetics[0].audio,
                                  });
                            n++;
                              }; // end the third
                              k++;
                        } else // else of the second
                        {
                          j++;k=0;
                        } // end of the second 
                      } else // else of first
                      {
                      isComplete = true;
                      } // end of the first
                    } // end of while   
                  }else{ 
                    alert("error"); //萬一沒load完就跑下面顯示錯誤提示
                  }
                })
                .catch( (error) => {
                  alert(error);
                });
               };
               

            const changeMeaning = () => {

                // meaningNumber.value=0;
                synonymList.value=[''];
                antonymList.value=[''];
                currentNumber.value++;
                if (currentNumber.value > meaningNumber.value) {
                  currentNumber.value=1; }
                  wordMeaning.value=meaningList[currentNumber.value-1].definition;
                  wordExample.value=meaningList[currentNumber.value-1].example;
                  partofSpeech.value='('+meaningList[currentNumber.value-1].partofSpeech+')';
                  synonymList.value =meaningList[currentNumber.value-1].synonyms;
                  antonymList.value =meaningList[currentNumber.value-1].antonyms;
               };

          const wordmeaning = (sword) => {
                meaningList.length=0;
                meaningNumber.value=0;
                showOr.value=true;
                storeOr.value=true;
                synonymList.value=[''];
                antonymList.value=[''];
                var isComplete= false;
                axios.get('https://api.dictionaryapi.dev/api/v2/entries/en_US/'+todoList[sword].title )
                .then((response) => {
                  if(response.request.readyState === 4 && response.status === 200){ //有load完才跑下面
                    // check data.length
                    var childArray=response.data;

                    for (j=0;j<childArray.length;j++){ 
                      for (k=0;k<childArray[j].meanings.length;k++){
                          meaningNumber.value+=childArray[j].meanings[k].definitions.length;
                        };};
                    j=0; k=0; m=0; n=0; //meaningList=[]; 
                    while (!isComplete) {

                      if (j<childArray.length) {

                        if (k<childArray[j].meanings.length) {

                          for (m=0;m<childArray[j].meanings[k].definitions.length;m++) {
                            meaningList.push({
                                  mId : n,
                                  partofSpeech: childArray[j].meanings[k].partOfSpeech,
                                  definition: childArray[j].meanings[k].definitions[m].definition,
                                  example: childArray[j].meanings[k].definitions[m].example,
                                  synonyms: childArray[j].meanings[k].definitions[m].synonyms,
                                  antonyms: childArray[j].meanings[k].definitions[m].antonyms,
                                  });
                            n++;
                              }; // end the third
                              k++;
                        } else // else of the second
                        {
                          j++;k=0;
                        } // end of the second 
                      } else // else of first
                      {
                      isComplete = true;
                      } // end of the first
                    } // end of while   
                    wordMeaning.value=response.data[0].meanings[0].definitions[0].definition;
                    wordExample.value=response.data[0].meanings[0].definitions[0].example;
                    showOr.value=true;
                    phonetic.value='['+response.data[0].phonetic+']';
                    thisword.value=todoList[sword].title;
                    thisId.value= todoList[sword].id;
                    phoneticAudio.value="https:"+response.data[0].phonetics[0].audio;
                    partofSpeech.value='('+response.data[0].meanings[0].partOfSpeech+')';
                    synonymList.value = response.data[0].meanings[0].definitions[0].synonyms;
                    antonymList.value = response.data[0].meanings[0].definitions[0].antonyms;
                    
                    currentNumber.value =1;
                  }else{ 
                    alert("error"); //萬一沒load完就跑下面顯示錯誤提示
                  }
                })
                .catch( (error) => {
                  wordMeaning.value="";
                  wordExample.value="";
                  partofSpeech.value="";
                  showOr.value=false;
                  thisword.value="["+todoList[sword].title+"] not found";
                  phonetic.value="";
                  synonymList.value=[''];
                  antonymList.value=[''];
                  console.log("此單字找不到解釋");
               });
          }; 

          const playSound = (sound) => {
            if(sound) {
              var audio = new Audio(sound);
              audio.play();
          };
        };

          // 若單字沒有查到說明，可以用這個功能置換新單字
          const changeword = (cid) => {
                var words=[];
                const index = todoList.findIndex(checkid)
                function checkid(wordlist) {
                  return wordlist.id === cid; 
                }
                axios.get('https://random-word-api.herokuapp.com/word?number=1')
                .then((response) => {
                    words=response.data;
                    todoList[index].title = words[0];
                    wordmeaning(index);
                    });
              
                };

          const setRemeberWord = (strData,cindex) => { 
                pushData(strData);
                removeTodo(cindex);
              };
          // 將已背好的單字，傳到pushData，並用JSON格式存在Localstorage
          const pushData = (strData) => { 
            var d = new Date();
            d.setTime(Date.now());
            // 建立以前的單字資料
            // d.setFullYear(2020, 11, 9);
            // 不用問
            // var n = d.getTime();          
                // $q.dialog({
                //   title: 'Confirm',
                //   message: 'Do you save : '+ strData + '?',
                //   cancel: true,
                //   persistent: true
                // }).onOk(() => {
                  rememberofYear.value++;
                  rememberofToday.value++;
                  rememberofMonth.value++;
                  history.push({
                    // 建立以前的單字
                    // id: n,
                    id: Date.now(),
                    title: strData,
                  });
                  showList.push({
                    title: strData,
                    year: d.getFullYear(),
                    month: d.getMonth(),
                    day: d.getDate(),
                  });
                  // refresh by today
                  setShowlist(d.getFullYear(),d.getMonth(),d.getDate());
                  // update yearList,monthList,HistoryList
                  var index = yearList.findIndex(checkyear)
                    function checkyear(templist) {
                        return templist.year === d.getFullYear(); 
                    }     
                    if (index>0)              
                    yearList[index].number++; 

                    var index = monthfilterList.findIndex(checkmonth)
                    function checkmonth(templist) {
                        return templist.year === d.getFullYear() && templist.month === d.getMonth(); 
                    }                 
                    if (index>0)              
                    monthfilterList[index].number++; 

                    var index = historyList.findIndex(updatehistory)
                    function updatehistory(templist) {
                        return templist.year === d.getFullYear() && templist.month === d.getMonth() && templist.day === d.getDate(); 
                    }  
                    // check 
                    if (index>0)              
                    historyList[index].number++; 

                  let objData = JSON.stringify(history);
                  // store here, change to store by id
                  localStorage.setItem('newword', objData);

                // }).onCancel(() => {
                //   $q.notify({
                //   message: '放棄 '+ strData+' 儲存',
                //   icon: 'gavel'
                // })

                // });
              };
          // 讀取 LocalStorage的曾經背過的單字
          const getRememberWord = () => { 
            var tempHistory = JSON.parse(localStorage.getItem('newword'));
            var d = new Date();
            var d_today = new Date();
            // var d_i = 0;
            rememberofYear.value=0;
            rememberofToday.value=0;
            rememberofMonth.value=0;

                if (localStorage.getItem('newword')) {
                  tempHistory.forEach(item => {
                    d_today.setTime(Date.now());
                               // if (item.id ==null)
                              // item_id= Date.now() + d_i++;
                    
                    d.setTime(item.id);

                    if (datesAreOnSameMonth(d,d_today)) {
                      rememberofMonth.value++;
                    }

                    if ( datesAreOnSameDay(d,d_today) ) {
                      rememberofToday.value++;
                      showList.push({
                        id: item.id,
                        title: item.title,
                        year: d.getFullYear(),
                        month: d.getMonth(),
                        day: d.getDate(),
                    });
                    };
                    rememberofYear.value++;
                    history.push({
                    id: item.id,
                    title: item.title,
                  });
                  });
 
                }
              };

            const setMonthlist =(year,month) => {
              showMonth.value=month;
              showYear.value=year;   
            }  

            const setYearlist =(year) => {
              showYear.value=year;
              monthfilterList.length=0;
              monthList.forEach(obj => {
                if (obj.year==year) 
                monthfilterList.push({
                  year: obj.year,
                  month: obj.month,
                  number: obj.number,
                 });
            })
          }  

            const setShowlist = (year,month,day) => { 
              var d = new Date();
              var d_showdate = new Date();
              var showdateStr='';


              showdateStr = numtoString(year,month+1,day);
              showDate.value = showdateStr;
              showList.length=0;
              d_showdate.setTime(Date.parse(showdateStr));
              rememberofToday.value=0;
              rememberofMonth.value=0;

              history.forEach(item => {
                // change to a function.
                d.setTime(item.id);
                if (datesAreOnSameMonth(d,d_showdate)) {
                  rememberofMonth.value++;
                }
                if ( datesAreOnSameDay(d,d_showdate) ) {
                  rememberofToday.value++;
                  showList.push({
                    id: item.id,
                    title: item.title,
                    year: d.getFullYear(),
                    month: d.getMonth(),
                    day: d.getDate(),
                });
                };
              });
              if (isDisplay.value == "block")
                setGame();
            }  

          const removeHistory = (title) => {

            const index = history.findIndex(checkid)
            function checkid(wordlist) {
                  return wordlist.title === title; 
                }
                history.splice(index, 1);
                let objData = JSON.stringify(history);
                  // store here, change to store by id
                localStorage.setItem('newword', objData);
            };
            const removeTodo = (cid) => {
            const index = todoList.findIndex(checkid)

            function checkid(wordlist) {
                  return wordlist.id === cid; 
                }
                
                todoList.splice(index, 1);
              };

            const datesAreOnSameDay = (first, second) =>
                first.getFullYear() === second.getFullYear() &&
                first.getMonth() === second.getMonth() &&
                first.getDate() === second.getDate();   

            const datesAreOnSameMonth = (first, second) =>
                first.getFullYear() === second.getFullYear() &&
                first.getMonth() === second.getMonth();

          const checkhistory = (obj) => {
              let BreakException = {};
              var finditem=false;
              var addone=0;
              try {
              historyList.forEach(function(obj1,index){
                  if (obj1.year==getyear(obj.id) && obj1.month==getmonth(obj.id) && obj1.day==getday(obj.id)){
                  addone=obj1.number+1;
                  obj1.number=addone;
                  finditem=true;
                  throw BreakException;  
                  }
              });
              } catch (e) {
                  if (e !== BreakException) throw e;
              }
              if (!finditem) {
                  historyList.push({
                  year: getyear(obj.id),
                  month: getmonth(obj.id),
                  day: getday(obj.id),
                  number: 1,
                  });
              } 
          }

          const checkMonth = (obj) => {
              let BreakException = {};
              var finditem=false;
              var addnumber=0;
              try {
              monthList.forEach(function(obj1,index){
                  if (obj1.year==obj.year && obj1.month==obj.month){
                  addnumber=obj.number;
                  obj1.number=obj1.number+addnumber;
                  finditem=true;
                  throw BreakException;  
                  }
              });
              } catch (e) {
                  if (e !== BreakException) throw e;
              }
              if (!finditem) {
                  monthList.push({
                  year: obj.year,
                  month: obj.month,
                  number: obj.number,
                  });
              } 
          }

          const checkYear = (obj) => {
              let BreakException = {};
              var finditem=false;
              var addnumber=0;
              try {
              yearList.forEach(function(obj1,index){
                  if (obj1.year==obj.year){
                  addnumber=obj.number;
                  obj1.number=obj1.number+addnumber;
                  finditem=true;
                  throw BreakException;  
                  }
              });
              } catch (e) {
                  if (e !== BreakException) throw e;
              }
              if (!finditem) {
                  yearList.push({
                  year: obj.year,
                  number: obj.number,
                  });
              } 
          }

          const numtoStringY = (year) => {
            return year.toString();
            
          }

          const numtoStringM = (year,month) => {
            return year.toString()+'/'+month.toString()
          }

          const numtoString = (year,month,day) => {
            return year.toString()+'/'+month.toString()+'/'+day.toString()
          }
          const getyear =(dateid) => {
            var tempdate= new Date();
            tempdate.setTime(dateid);
            return tempdate.getFullYear()
          }
          const getmonth =(dateid) => {
            var tempdate= new Date();
            tempdate.setTime(dateid);
            return tempdate.getMonth()
          }
          const getday =(dateid) => {
            var tempdate= new Date();
            tempdate.setTime(dateid);
            return tempdate.getDate()
          }


            return {
              todoList,
              words,
              history,
              historyList,
              monthList,
              monthfilterList,
              yearList,
              showMonth,
              showYear,
              showDate,
              showList,
              wordMeaning,
              wordmeaning,
              wordExample,
              thisword,
              thisId,
              lastword,
              phonetic,
              phoneticAudio,
              meaningNumber,
              currentNumber,
              rememberofToday,
              rememberofYear,
              rememberofMonth,
              rememberofshow,
              meaningList,
              meaningameList,
              answeris,
              answerExample,
              answerAudio,
              quiztxt,
              partofSpeech,
              synonymList,
              antonymList,
              changeword,
              setRemeberWord,
              getRememberWord,
              pushData,
              historymeaning,
              meaningforGame,
              gameMatch,
              playSound,
              changeMeaning,
              datesAreOnSameDay,
              datesAreOnSameMonth,
              checkhistory,
              checkMonth,
              checkYear,
              numtoString,
              numtoStringM,
              numtoStringY,
              removeHistory,
              removeTodo,
              setShowlist,
              setMonthlist,
              setYearlist,
              setGame,
              gameOver,
              answerQuiz,
              random_item,
              newWord,
              // get_random_word,
              showOr,
              storeOr,
              slide,
              slide1,
              isFullscreen,
              isDisplay,
              text,
            }
          }
    }

const myapp = Vue.createApp(app);
myapp.use(Quasar, { config: {notify:{}} });
myapp.mount('#q-app');

</script>


</body>
</html>
